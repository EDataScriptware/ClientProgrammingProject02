<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>340 p2 ex</title>
	<script src="https://code.jquery.com/jquery-latest.js" type="text/javascript"></script>
	<script src="jquery-3.4.1.js" type="text/javascript"> </script>

<script type="text/javascript">
	// P2 Start
	//now what?
	//api:  http://www.ist.rit.edu/api/
	$(document).ready(function()
	{
		// get the /about/ information onto the page
		myXHR('get',{'path':'/about/'}).done(function(json)
		{
			var x = '<h2>'+json.title+'</h2>';
			x+= '<p>' + json.description+'</p>';
			x+= '<p>' + json.quote+'</p>';
			x+= '<p>' + json.quoteAuthor+'</p>';

			// add this X to the page
			$('#about').html(x);
		}); // end /about/


		// The degreeName is acting up
		myXHR('get',{'path':'/degrees/undergraduate/degreeName=cit'}).done(function(json)
		{
			console.log(json);

			var x='';
			$.each(json.undergraduate,function(i, item)
			{
				var x = '<h2>'+ item.title + '(' + item.degreeName + ')</h2>';
				x+= '<p>' + item.description+'</p>';

				var y = '<ul>';
				$.each(item.concentrations,function(j, item)
				{
					y+='<li>'+item+'</li>';
				});
				y+='</ul>'; 

				x+= y; // adding concentrations to the program information
				$('#contentUndergraduateCIT').html(x);
			}); // end json.undergraduate CIT

		}); // end degrees/undergraduate/CIT

		myXHR('get',{'path':'/degrees/undergraduate/degreeName=hcc'}).done(function(json)
		{
			console.log(json);

			var x='';
			$.each(json.undergraduate,function(i, item)
			{
				var x = '<h2>'+ item.title + '(' + item.degreeName + ')</h2>';
				x+= '<p>' + item.description+'</p>';

				var y = '<ul>';
				$.each(item.concentrations,function(j, item)
				{
					y+='<li>'+item+'</li>';
				});
				y+='</ul>'; 

				x+= y; // adding concentrations to the program information
				$('#contentUndergraduateHCC').html(x);
			}); // end json.undergraduate HCC

		}); // end degrees/undergraduate/HCC

		myXHR('get',{'path':'/degrees/undergraduate/degreeName=wmc'}).done(function(json)
		{
			console.log(json);

			var x='';
			$.each(json.undergraduate,function(i, item)
			{
				var x = '<h2>'+ item.title + '(' + item.degreeName + ')</h2>';
				x+= '<p>' + item.description+'</p>';

				var y = '<ul>';
				$.each(item.concentrations,function(j, item)
				{
					y+='<li>'+item+'</li>';
				});
				y+='</ul>'; 

				x+= y; // adding concentrations to the program information
				$('#contentUndergraduateWMC').html(x);
			}); // end json.undergraduate WMC

		}); // end degrees/undergraduate/WMC


		myXHR('get',{'path':'/degrees/graduate/'}).done(function(json)
		{
			console.log(json);

			var x='';
			$.each(json.graduate,function(i, item)
			{
				var x = '<h2>'+ item.title + '(' + item.degreeName + ')</h2>';
				x+= '<p>' + item.description+'</p>';

				var y = '<ul>';
				$.each(item.concentrations,function(j, item)
				{
					y+='<li>'+item+'</li>';
				});
				y+='</ul>'; 

				x+= y; // adding concentrations to the program information
				$('#contentGraduate').html(x);
			}); // end json.graduate

		}); // end degrees/graduate/



	}); // end ready function
	
	// AJAX function to get information
	// XHR is XML HTTP Request
	// t = get or post
	// d = path :/about/

	function myXHR(t,d)
	{
		return $.ajax({
			type: t,
			cache: false,
			async: true,
			dataType: 'json',
			url: 'proxy.php',
			data: d,
			beforeSend:function()
			{
				//do this before sending the request
				$('<img src="gears.gif" id="spinner" style="position:relative; top:50px; left:50px; z-index:2000"/>')
				.appendTo("body");
			} // end before send
		}).always(function()
		{
			//happens at the end, no matter what
			$('#spinner').remove();
			
		//end always
		}).fail(function() 
		{
			// if our request fails to work
			console.log("Failure with " +  d.path);
		}) // end fail
	}



</script>
</head>
<body>
  <h2>IST Dept Site</h2>
	<section id="people"></section>
  
	<section id="contentUndergraduateCIT" style="height:300px"></section>
	<section id="contentUndergraduateHCC" style="height:300px"></section>
	<section id="contentUndergraduateWMC" style="height:300px"></section>

	<section id="contentGraduate" style="height:300px"></section>
	
	<section id="about" style="height:200px"></section>

</body>
</html>
